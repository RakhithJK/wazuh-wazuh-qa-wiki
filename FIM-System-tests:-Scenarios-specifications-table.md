## Scenarios specifications table

| ID   | Title                                                      | Purpose                                                                                                                           | Configuration                                                                                                         | Input values                                                             | Result                                                                                                                                                                                                                                |
|------|------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 0201 | Default syscheck configuration: Linux/Windows              | To ensure that the same number of syscheck alertsare produced in the same environment, so no false positives arereported.         | Default syscheck configuration- queue_size: 15000- events_per_second: 500                                             | NULL                                                                     | A static number of syscheck alerts indexedin Elasticsearch.                                                                                                                                                                           |
| 0202 | Real time monitoring - add: Linux/Windows                  | To ensure the 'realtime' feature takes effect in time.                                                                            | 1. Monitor /opt/fim_testing with 320 recursion level.2. realtime='yes', check_all="yes"                               | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                | The number of alerts must ONLY matchin Elasticsearch to the number of added files. Alsothe timestamp should be close in time to thetimestamp of the alert generation.                                                                 |
| 0203 | Whodata Linux/Windows                                      | To ensure the 'whodata' feature takes effect in time.                                                                             | 1. Monitor /opt/fim_testing with 320 recursion level.2. whodata='yes', check_all="yes"                                | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                | The number of alerts must ONLY matchin Elasticsearch to the number of added files. Alsothe timestamp should be close in time to thetimestamp of the alert generation, and the fieldsof the alerts must be matching to Whodata fields. |
| 0204 | Whodata Linux - no audit installed                         | To ensure the missing dependency isproperly handled.                                                                              | 1. Monitor /opt/fim_testing with 320 recursion level.2. whodata='yes', check_all="yes"                                | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                | An Error log must be provoked in thealerts.log, and realtime mode should beswitched to. Jump to #F3                                                                                                                                   |
| 0205 | Use of restrict option: Linux/Windows                      | To ensure that only restricted files are effectively monitored.                                                                   | 1. Monitor /opt/fim_testing with 320 recursion level.2. frequency="10" check_all="yes"3. restrict="^ignoredfile.txt$" | Create an 'ignoredfile.txt' file within /homewhile creating other files. | There should only be one alert related to the restricted file.                                                                                                                                                                        |
| 0206 | Use of tags: Linux/Windows                                 | To be sure that alerts are generated with thespecified tags.                                                                      | 1. Monitor /opt/fim_testing with 320 recursion level.2. frequency="10" check_all="yes"3. tags="tagtest"               | Create a test file.                                                      | There should be one alert with the specified tag within its body.                                                                                                                                                                     |
| 0207 | Use of report changes: Linux/Windows                       | To be sure that the content of the change is in the alert.                                                                        | 1. Monitor /opt/fim_testing with 320 recursion level.2. frequency="10" check_all="yes"3. report_changes="yes"         | Modify a monitored file.                                                 | There should be one alert with the text change within the body.                                                                                                                                                                       |
| 0208 | Use of ignore files: Linux/Windows                         | To be sure that specified files are ignored and not monitored.                                                                    | 1.<ignore type="sregex">.mp3$|.avi$|.mpg$</ignore>frequency="10"                                                      | Create a file that satisfies the ignored type regex.                     | There should not be any alert related to this action.                                                                                                                                                                                 |
| 0209 | Recursion level.                                           | Check the behavior of the recursion_level option.                                                                                 | 1. Monitor /opt/fim_testing with 4 recursion level.2. frequency="10" ', check_all="yes"                               | Create files at level 4. Also create alevel 5 folder with some files.    | There should only be alerts related to the files untillevel 4. No alerts must be triggered from level 5 files.                                                                                                                        |
| 0210 | Scheduled scan                                             | Check that the scans are effectively launched when reachedthe specified time.                                                     | 1. Monitor /opt/fim_testing with 320 recursion level.2. frequency="10" , check_all="yes"                              | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                | After the specified time, the scan must launchand the alerts must be triggered.                                                                                                                                                       |
| 0211 | Custom configuration                                       | Check the filters applied and the custom configuration works properly                                                             | 1. Monitor different <directories> folder                                                                             | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                | After the specified time, the scan must launchand the alerts must be triggered.                                                                                                                                                       |
| 0212 | Check overlap of scheduled syscheck scan and realtime scan | Determine how does the periodic fim scan affect to realtime and if theoverlap produces failures in alert generation or big delays | 1. Monitor /opt/fim_testing with 4 recursion level.2. frequency="10" ', check_all="yes"                               | 2. Generate 1,100, 1000 and 10.000 filesat the same time.                |                                                                                                                                                                                                                                       |